<!DOCTYPE html><html lang="en-US"><head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet" disabled=""> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li:not(:nth-child(6)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(6) > ul > li:nth-child(1) > ul > li:nth-child(6) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(6) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(6) > ul > li:nth-child(1) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(6) > ul > li:nth-child(1) > ul > li:nth-child(6) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(6) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(6) > ul.nav-list > li.nav-list-item:nth-child(1) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(6) > ul.nav-list > li.nav-list-item:nth-child(1) > ul.nav-list > li.nav-list-item:nth-child(6) > ul.nav-list { display: block; } </style> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="icon" href="/images/favicon.ico" type="image/x-icon"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Alternatives to using OOResult and OOVoidResult in OOBibBase | Developer Documentation</title> <meta name="generator" content="Jekyll v4.3.4"> <meta property="og:title" content="Alternatives to using OOResult and OOVoidResult in OOBibBase"> <meta property="og:locale" content="en_US"> <meta name="description" content="Graphical Java application for managing BibTeX and BibLaTeX (.bib) databases"> <meta property="og:description" content="Graphical Java application for managing BibTeX and BibLaTeX (.bib) databases"> <link rel="canonical" href="/code-howtos/openoffice/ooresult-ooerror/ooresult-alternatives.html"> <meta property="og:url" content="/code-howtos/openoffice/ooresult-ooerror/ooresult-alternatives.html"> <meta property="og:site_name" content="Developer Documentation"> <meta property="og:type" content="website"> <meta name="twitter:card" content="summary"> <meta property="twitter:title" content="Alternatives to using OOResult and OOVoidResult in OOBibBase"> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Graphical Java application for managing BibTeX and BibLaTeX (.bib) databases","headline":"Alternatives to using OOResult and OOVoidResult in OOBibBase","url":"/code-howtos/openoffice/ooresult-ooerror/ooresult-alternatives.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"></path> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"></path> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"></path> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"></path> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> Developer Documentation </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Overview on Developing JabRef</a></li><li class="nav-list-item"><a href="/contributing.html" class="nav-list-link">Contributing</a></li><li class="nav-list-item"><a href="/teaching.html" class="nav-list-link">JabRef and Software Engineering Training</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Decision Records category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/decisions/" class="nav-list-link">Decision Records</a><ul class="nav-list"><li class="nav-list-item"><a href="/decisions/0000-use-markdown-architectural-decision-records.html" class="nav-list-link">Use Markdown Architectural Decision Records</a></li><li class="nav-list-item"><a href="/decisions/0001-use-crowdin-for-translations.html" class="nav-list-link">Use Crowdin for translations</a></li><li class="nav-list-item"><a href="/decisions/0002-use-slf4j-for-logging.html" class="nav-list-link">Use SLF4J together with log4j2 for logging</a></li><li class="nav-list-item"><a href="/decisions/0003-use-gradle-as-build-tool.html" class="nav-list-link">Use Gradle as build tool</a></li><li class="nav-list-item"><a href="/decisions/0004-use-mariadb-connector.html" class="nav-list-link">Use MariaDB Connector</a></li><li class="nav-list-item"><a href="/decisions/0005-fully-support-utf8-only-for-latex-files.html" class="nav-list-link">Fully Support UTF-8 Only For LaTeX Files</a></li><li class="nav-list-item"><a href="/decisions/0006-only-translated-strings-in-language-file.html" class="nav-list-link">Only translated strings in language file</a></li><li class="nav-list-item"><a href="/decisions/0007-human-readable-changelog.html" class="nav-list-link">Provide a human-readable changelog</a></li><li class="nav-list-item"><a href="/decisions/0008-use-public-final-instead-of-getters.html" class="nav-list-link">Use public final instead of getters to offer access to immutable variables</a></li><li class="nav-list-item"><a href="/decisions/0009-use-plain-junit5-for-testing.html" class="nav-list-link">Use Plain JUnit5 for advanced test assertions</a></li><li class="nav-list-item"><a href="/decisions/0010-use-h2-as-internal-database.html" class="nav-list-link">Use H2 as Internal SQL Database</a></li><li class="nav-list-item"><a href="/decisions/0011-test-external-links-in-documentation.html" class="nav-list-link">Test external links in documentation</a></li><li class="nav-list-item"><a href="/decisions/0012-handle-different-bibEntry-formats-of-fetchers.html" class="nav-list-link">Handle different bibentry formats of fetchers by adding a layer</a></li><li class="nav-list-item"><a href="/decisions/0013-add-native-support-biblatex-software.html" class="nav-list-link">Add Native Support for BibLatex-Software</a></li><li class="nav-list-item"><a href="/decisions/0014-separate-URL-creation-to-enable-proper-logging.html" class="nav-list-link">Separate URL creation to enable proper logging</a></li><li class="nav-list-item"><a href="/decisions/0015-support-an-abstract-query-syntax-for-query-conversion.html" class="nav-list-link">Query syntax design</a></li><li class="nav-list-item"><a href="/decisions/0016-mutable-preferences-objects.html" class="nav-list-link">Mutable preferences objects</a></li><li class="nav-list-item"><a href="/decisions/0017-allow-model-access-logic.html" class="nav-list-link">Allow org.jabref.model to access org.jabref.logic</a></li><li class="nav-list-item"><a href="/decisions/0018-use-regular-expression-to-split-multiple-sentence-titles.html" class="nav-list-link">Use regular expression to split multiple-sentence titles</a></li><li class="nav-list-item"><a href="/decisions/0019-implement-special-fields-as-separate-fields.html" class="nav-list-link">Implement special fields as separate fields</a></li><li class="nav-list-item"><a href="/decisions/0020-use-Jackson-to-parse-study-yml.html" class="nav-list-link">Use Jackson to parse study.yml</a></li><li class="nav-list-item"><a href="/decisions/0021-keep-study-as-a-dto.html" class="nav-list-link">Keep study as a DTO</a></li><li class="nav-list-item"><a href="/decisions/0022-remove-stop-words-during-query-transformation.html" class="nav-list-link">Remove stop words during query transformation</a></li><li class="nav-list-item"><a href="/decisions/0023-localized-preferences.html" class="nav-list-link">Localized Preferences</a></li><li class="nav-list-item"><a href="/decisions/0024-use-%23-as-indicator-for-BibTeX-string-constants.html" class="nav-list-link">Use # as indicator for BibTeX string constants</a></li><li class="nav-list-item"><a href="/decisions/0025-reviewdog-reviews.html" class="nav-list-link">Reviewdog findings are code reviews</a></li><li class="nav-list-item"><a href="/decisions/0026-use-jna-to-determine-default-directory.html" class="nav-list-link">Use Java Native Access to Determine Default Directory</a></li><li class="nav-list-item"><a href="/decisions/0032-store-chats-in-local-user-folder.html" class="nav-list-link">Store Chats Alongside Database</a></li><li class="nav-list-item"><a href="/decisions/0027-synchronization.html" class="nav-list-link">Synchronization with remote databases</a></li><li class="nav-list-item"><a href="/decisions/0033-store-chats-in-mvstore.html" class="nav-list-link">Store Chats in MVStore</a></li><li class="nav-list-item"><a href="/decisions/0028-http-return-bibtex-string.html" class="nav-list-link">Return BibTeX string and CSL Item JSON in the API</a></li><li class="nav-list-item"><a href="/decisions/0034-use-citation-key-for-grouping-chat-messages.html" class="nav-list-link">Use Citation Key for Grouping Chat Messages</a></li><li class="nav-list-item"><a href="/decisions/0029-cff-export-multiple-entries.html" class="nav-list-link">Exporting multiple entries to CFF</a></li><li class="nav-list-item"><a href="/decisions/0035-generate-embeddings-online.html" class="nav-list-link">Generate Embeddings Online</a></li><li class="nav-list-item"><a href="/decisions/0030-use-apache-commons-io-for-directory-monitoring.html" class="nav-list-link">Use Apache Commons IO for directory monitoring</a></li><li class="nav-list-item"><a href="/decisions/0036-use-textarea-for-chat-content.html" class="nav-list-link">Use TextArea for Chat Message Content</a></li><li class="nav-list-item"><a href="/decisions/0031-use-current-tab-for-deciding-style-type-for-oo.html" class="nav-list-link">Use currently active tab in Select style (OO Panel) to decide style type</a></li><li class="nav-list-item"><a href="/decisions/0037-rag-architecture-implementation.html" class="nav-list-link">RAG Architecture Implementation</a></li><li class="nav-list-item"><a href="/decisions/0042-use-webview-for-summarization-content.html" class="nav-list-link">Use WebView for Chat Message Content</a></li><li class="nav-list-item"><a href="/decisions/0038-use-entryId-for-bibentries.html" class="nav-list-link">Use BibEntry.getId for BibEntry at indexing</a></li><li class="nav-list-item"><a href="/decisions/0039-use-apache-velocity-as-template-engine.html" class="nav-list-link">Use Apache Velocity as template engine</a></li><li class="nav-list-item"><a href="/decisions/0040-display-front-cover-in-preview-tab.html" class="nav-list-link">Display front cover for book citations in the Preview tab</a></li><li class="nav-list-item"><a href="/decisions/0043-show-merge-dialog-when-importing-a-single-pdf.html" class="nav-list-link">Show merge dialog when importing a single PDF</a></li><li class="nav-list-item"><a href="/decisions/adr-template.html" class="nav-list-link">ADR Template</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Getting into the code category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/getting-into-the-code/" class="nav-list-link">Getting into the code</a><ul class="nav-list"><li class="nav-list-item"><a href="/getting-into-the-code/development-strategy.html" class="nav-list-link">JabRef’s development strategy</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Set up a local workspace category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/getting-into-the-code/guidelines-for-setting-up-a-local-workspace/" class="nav-list-link">Set up a local workspace</a><ul class="nav-list"><li class="nav-list-item"><a href="/getting-into-the-code/guidelines-for-setting-up-a-local-workspace/pre-01-github-account.html" class="nav-list-link">Pre Condition 1: GitHub Account</a></li><li class="nav-list-item"><a href="/getting-into-the-code/guidelines-for-setting-up-a-local-workspace/pre-02-software.html" class="nav-list-link">Pre Condition 2: Required Software</a></li><li class="nav-list-item"><a href="/getting-into-the-code/guidelines-for-setting-up-a-local-workspace/pre-03-code.html" class="nav-list-link">Pre Condition 3: Code on the local machine</a></li><li class="nav-list-item"><a href="/getting-into-the-code/guidelines-for-setting-up-a-local-workspace/intellij-11-code-into-ide.html" class="nav-list-link">Step 1: Get the code into IntelliJ</a></li><li class="nav-list-item"><a href="/getting-into-the-code/guidelines-for-setting-up-a-local-workspace/intellij-12-build.html" class="nav-list-link">Step 2: Set up the build system: JDK and Gradle</a></li><li class="nav-list-item"><a href="/getting-into-the-code/guidelines-for-setting-up-a-local-workspace/intellij-13-code-style.html" class="nav-list-link">Step 3: Set up JabRef’s code style</a></li><li class="nav-list-item"><a href="/getting-into-the-code/guidelines-for-setting-up-a-local-workspace/intellij-89-run-with-intellij.html" class="nav-list-link">Advanced: Build and run using IntelliJ IDEA</a></li><li class="nav-list-item"><a href="/getting-into-the-code/guidelines-for-setting-up-a-local-workspace/eclipse.html" class="nav-list-link">Advanced: Eclipse as IDE</a></li><li class="nav-list-item"><a href="/getting-into-the-code/guidelines-for-setting-up-a-local-workspace/vscode.html" class="nav-list-link">Advanced: VS Code as IDE</a></li><li class="nav-list-item"><a href="/getting-into-the-code/guidelines-for-setting-up-a-local-workspace/trouble-shooting.html" class="nav-list-link">Trouble shooting</a></li></ul></li><li class="nav-list-item"><a href="/getting-into-the-code/high-level-documentation.html" class="nav-list-link">High-level documentation</a></li></ul></li><li class="nav-list-item active"><button class="nav-list-expander btn-reset" aria-label="toggle items in Code Howtos category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/code-howtos/" class="nav-list-link">Code Howtos</a><ul class="nav-list"><li class="nav-list-item active"><button class="nav-list-expander btn-reset" aria-label="toggle items in The LibreOffice Panel category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/code-howtos/openoffice/" class="nav-list-link">The LibreOffice Panel</a><ul class="nav-list"><li class="nav-list-item"><a href="/code-howtos/openoffice/overview.html" class="nav-list-link">Overview</a></li><li class="nav-list-item"><a href="/code-howtos/openoffice/order-of-appearance.html" class="nav-list-link">Order of appearance of citation groups</a></li><li class="nav-list-item"><a href="/code-howtos/openoffice/problems.html" class="nav-list-link">Problems</a></li><li class="nav-list-item"><a href="/code-howtos/openoffice/code-reorganization.html" class="nav-list-link">Code reorganization</a></li><li class="nav-list-item"><a href="/code-howtos/openoffice/ooresult-ooerror/" class="nav-list-link">About OOError, OOResult, and OOVoidResult</a></li><li class="nav-list-item active"><a class="nav-list-link active">Alternatives to using OOResult and OOVoidResult in OOBibBase</a></li></ul></li><li class="nav-list-item"><a href="/code-howtos/code-quality.html" class="nav-list-link">Code Quality</a></li><li class="nav-list-item"><a href="/code-howtos/custom-svg-icons.html" class="nav-list-link">Custom SVG icons</a></li><li class="nav-list-item"><a href="/code-howtos/error-handling.html" class="nav-list-link">Error Handling in JabRef</a></li><li class="nav-list-item"><a href="/code-howtos/eventbus.html" class="nav-list-link">Event Bus and Event System</a></li><li class="nav-list-item"><a href="/code-howtos/fetchers.html" class="nav-list-link">Fetchers</a></li><li class="nav-list-item"><a href="/code-howtos/faq.html" class="nav-list-link">Frequently Asked Questions (FAQ)</a></li><li class="nav-list-item"><a href="/code-howtos/http-server.html" class="nav-list-link">HTTP Server</a></li><li class="nav-list-item"><a href="/code-howtos/IntelliJ.html" class="nav-list-link">IntelliJ Hints</a></li><li class="nav-list-item"><a href="/code-howtos/jpackage.html" class="nav-list-link">JPackage: Creating a binary and debug it</a></li><li class="nav-list-item"><a href="/code-howtos/bibtex.html" class="nav-list-link">JabRef’s handling of BibTeX</a></li><li class="nav-list-item"><a href="/code-howtos/javafx.html" class="nav-list-link">JavaFX</a></li><li class="nav-list-item"><a href="/code-howtos/localization.html" class="nav-list-link">Localization</a></li><li class="nav-list-item"><a href="/code-howtos/logging.html" class="nav-list-link">Logging</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Remote Storage category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/code-howtos/remote-storage.html" class="nav-list-link">Remote Storage</a><ul class="nav-list"><li class="nav-list-item"><a href="/code-howtos/remote-storage-jabdrive.html" class="nav-list-link">Remote JabDrive storage</a></li><li class="nav-list-item"><a href="/code-howtos/remote-storage-sql.html" class="nav-list-link">Remote SQL Storage</a></li></ul></li><li class="nav-list-item"><a href="/code-howtos/testing.html" class="nav-list-link">Testing JabRef</a></li><li class="nav-list-item"><a href="/code-howtos/ui-recommendations.html" class="nav-list-link">UI Design Recommendations</a></li><li class="nav-list-item"><a href="/code-howtos/tools.html" class="nav-list-link">Useful development tooling</a></li><li class="nav-list-item"><a href="/code-howtos/xmp-parsing.html" class="nav-list-link">XMP Parsing</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Requirements category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/requirements/" class="nav-list-link">Requirements</a><ul class="nav-list"><li class="nav-list-item"><a href="/requirements/ai.html" class="nav-list-link">AI</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Developer Documentation" aria-label="Search Developer Documentation" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://gitter.im/JabRef/jabref" class="site-button"> Gitter Chat </a> </li> <li class="aux-nav-list-item"> <a href="https://discourse.jabref.org/" class="site-button"> Discussion Forum </a> </li> <li class="aux-nav-list-item"> <a href="https://github.com/jabref/jabref/" class="site-button"> Code Repository </a> </li> </ul> </nav> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/code-howtos/">Code Howtos</a></li> <li class="breadcrumb-nav-list-item"><a href="/code-howtos/openoffice/">The LibreOffice Panel</a></li> <li class="breadcrumb-nav-list-item"><span>Alternatives to using OOResult and OOVoidResult in OOBibBase</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h1 id="alternatives-to-using-ooresult-and-oovoidresult-in-oobibbase"> <a href="#alternatives-to-using-ooresult-and-oovoidresult-in-oobibbase" class="anchor-heading" aria-labelledby="alternatives-to-using-ooresult-and-oovoidresult-in-oobibbase"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Alternatives to using OOResult and OOVoidResult in OOBibBase </h1> <p>(Talk about ADRs prompted me to think about alternatives to what I used.)</p> <p>Situation:</p> <ul> <li>some tests return no data, only report problems</li> <li>we may need to get some resources that might not be available (for example: connection to a document, a functional textview cursor)</li> <li>some test depend on these resources</li> </ul> <p>One strategy could be to use a single try-catch around the whole body, then showing a message based on the type of exceptions thrown.</p> <h2 id="base-case"> <a href="#base-case" class="anchor-heading" aria-labelledby="base-case"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> [base case] </h2> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span> <span class="o">{</span>
   <span class="no">A</span> <span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="o">();</span>
   <span class="no">B</span> <span class="n">b</span> <span class="o">=</span> <span class="n">g</span><span class="o">(</span><span class="n">a</span><span class="o">);</span>
   <span class="n">realAction</span><span class="o">(</span><span class="n">a</span><span class="o">,</span><span class="n">b</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">FirstExceptionType</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
   <span class="n">showDialog</span><span class="o">(</span> <span class="n">title</span><span class="o">,</span> <span class="n">messageForFirstExceptionType</span><span class="o">(</span><span class="n">ex</span><span class="o">)</span> <span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">SecondExceptionType</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
   <span class="n">showDialog</span><span class="o">(</span> <span class="n">title</span><span class="o">,</span> <span class="n">messageForSecondExceptionType</span><span class="o">(</span><span class="n">ex</span><span class="o">)</span> <span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
   <span class="n">showDialog</span><span class="o">(</span> <span class="n">title</span><span class="o">,</span> <span class="n">messageForOtherExceptions</span><span class="o">(</span><span class="n">ex</span><span class="o">)</span> <span class="o">);</span>
<span class="o">}</span>
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div> <p>This our base case.</p> <p>It is not clear from the code, nor within the catch branches (unless we start looking into stack traces) which call (<code class="language-plaintext highlighter-rouge">f()</code>, <code class="language-plaintext highlighter-rouge">g(a)</code> or <code class="language-plaintext highlighter-rouge">realAction(a,b)</code>) resulted in the exception. This limits the specificity of the message and makes it hard to think about the “why” can we get this exception here?</p> <h2 id="catch-around-each-call"> <a href="#catch-around-each-call" class="anchor-heading" aria-labelledby="catch-around-each-call"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Catch around each call? </h2> <p>A more detailed strategy would be to try-catch around each call.<br> In case we need a result from the call, this means either increasingly indented code (try-in-try).</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span> <span class="o">{</span>
   <span class="no">A</span> <span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="o">();</span>
   <span class="k">try</span> <span class="o">{</span>
      <span class="no">B</span> <span class="n">b</span> <span class="o">=</span> <span class="n">g</span><span class="o">(</span><span class="n">a</span><span class="o">);</span>
      <span class="k">try</span> <span class="o">{</span>
         <span class="n">realAction</span><span class="o">(</span><span class="n">ab</span><span class="o">);</span>
      <span class="o">}</span> <span class="k">catch</span> <span class="o">(...){</span>
         <span class="n">showDialog</span><span class="o">();</span>
      <span class="o">}</span>
   <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="no">G</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
     <span class="n">showDialog</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="n">ex</span><span class="o">);</span> <span class="c1">// title describes which GUI action we are in</span>
   <span class="o">}</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="no">F</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
   <span class="c1">// could an F be thrown in g?</span>
    <span class="n">showDialog</span><span class="o">(</span> <span class="n">title</span><span class="o">,</span> <span class="n">ex</span> <span class="o">);</span>
<span class="o">}</span>
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div> <p>or (declare and fill later)</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">A</span> <span class="n">a</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="k">try</span> <span class="o">{</span>
   <span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="o">();</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="no">F</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">showDialog</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="n">ex</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>
<span class="no">B</span> <span class="n">b</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="k">try</span> <span class="o">{</span>
   <span class="n">b</span> <span class="o">=</span> <span class="n">g</span><span class="o">(</span><span class="n">a</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="no">G</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">showDialog</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="n">ex</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="n">realAction</span><span class="o">(</span><span class="n">ab</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(...){</span>
    <span class="n">showDialog</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div> <p>In either case, the code becomes littered with exception handling code.</p> <h2 id="catch-in-wrappers"> <a href="#catch-in-wrappers" class="anchor-heading" aria-labelledby="catch-in-wrappers"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Catch in wrappers? </h2> <p>We might push the try-catch into its own function.<br> If the wrapper is called multiple times, this may reduce duplication of the catch-and-assign-message part.</p> <p>We can show an error dialog here: <code class="language-plaintext highlighter-rouge">title</code> carries some information from the caller, the exeption caught brings some from below.</p> <p>We still need to notify the action handler (the caller) about failure. Since we have shown the dialog, we do not need to provide a message.</p> <h3 id="notify-caller-with-optional-result"> <a href="#notify-caller-with-optional-result" class="anchor-heading" aria-labelledby="notify-caller-with-optional-result"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Notify caller with <code class="language-plaintext highlighter-rouge">Optional</code> result </h3> <p>With <code class="language-plaintext highlighter-rouge">Optional</code> we get something like this:</p> <h4 id="dialog-in-wrap-return-optional"> <a href="#dialog-in-wrap-return-optional" class="anchor-heading" aria-labelledby="dialog-in-wrap-return-optional"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> [dialog in wrap, return Optional] </h4> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Optional</span><span class="o">&lt;</span><span class="no">A</span><span class="o">&gt;</span> <span class="nf">wrap_f</span><span class="o">(</span><span class="nc">String</span> <span class="n">title</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="k">return</span> <span class="nc">Optional</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">f</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="no">F</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">showDialog</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="n">ex</span><span class="o">);</span>
      <span class="k">return</span> <span class="nc">Optional</span><span class="o">.</span><span class="na">empty</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="nc">Optional</span><span class="o">&lt;</span><span class="no">B</span><span class="o">&gt;</span> <span class="nf">wrap_g</span><span class="o">(</span><span class="nc">String</span> <span class="n">title</span><span class="o">,</span> <span class="no">A</span> <span class="n">a</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
       <span class="k">return</span> <span class="nc">Optional</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">g</span><span class="o">(</span><span class="n">a</span><span class="o">));</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="no">G</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">showDialog</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="n">ex</span><span class="o">);</span>
      <span class="k">return</span> <span class="nc">Optional</span><span class="o">.</span><span class="na">empty</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div> <p>and use it like this:</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Optional</span><span class="o">&lt;</span><span class="no">A</span><span class="o">&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">wrap_f</span><span class="o">(</span><span class="n">title</span><span class="o">);</span>
<span class="k">if</span> <span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span> <span class="k">return</span><span class="o">;</span> <span class="o">}</span>

<span class="nc">Optional</span><span class="o">&lt;</span><span class="no">B</span><span class="o">&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">wrap_g</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="n">a</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
<span class="k">if</span> <span class="o">(</span><span class="n">b</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span> <span class="k">return</span><span class="o">;</span> <span class="o">}</span>

<span class="k">try</span> <span class="o">{</span>
   <span class="n">realAction</span><span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">get</span><span class="o">(),</span> <span class="n">b</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(...)</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div> <p>This looks fairly regular.</p> <p>If <code class="language-plaintext highlighter-rouge">g</code> did not need <code class="language-plaintext highlighter-rouge">a</code>, we could simplify to</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Optional</span><span class="o">&lt;</span><span class="no">A</span><span class="o">&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">wrap_f</span><span class="o">(</span><span class="n">title</span><span class="o">);</span>
<span class="nc">Optional</span><span class="o">&lt;</span><span class="no">B</span><span class="o">&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">wrap_g</span><span class="o">(</span><span class="n">title</span><span class="o">);</span>
<span class="k">if</span> <span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">()</span> <span class="o">||</span> <span class="n">b</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span> <span class="k">return</span><span class="o">;</span> <span class="o">}</span>

<span class="k">try</span> <span class="o">{</span>
   <span class="n">realAction</span><span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">get</span><span class="o">(),</span> <span class="n">b</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(...)</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div> <h3 id="notify-caller-with-result-result"> <a href="#notify-caller-with-result-result" class="anchor-heading" aria-labelledby="notify-caller-with-result-result"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Notify caller with <code class="language-plaintext highlighter-rouge">Result</code> result </h3> <p>With <code class="language-plaintext highlighter-rouge">Result</code> we get something like this:</p> <h4 id="dialog-in-wrap-return-ooresult"> <a href="#dialog-in-wrap-return-ooresult" class="anchor-heading" aria-labelledby="dialog-in-wrap-return-ooresult"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> [dialog in wrap, return OOResult] </h4> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">OOResult</span><span class="o">&lt;</span><span class="no">A</span><span class="o">,</span> <span class="nc">OOError</span><span class="o">&gt;</span> <span class="nf">wrap_f</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="k">return</span> <span class="nc">OOResult</span><span class="o">.</span><span class="na">ok</span><span class="o">(</span><span class="n">f</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="no">F</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="nc">OOResult</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="nc">OOError</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">ex</span><span class="o">));</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="no">F2</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
      <span class="nc">String</span> <span class="n">message</span> <span class="o">=</span> <span class="s">"..."</span><span class="o">;</span>
      <span class="k">return</span> <span class="nc">OOResult</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="k">new</span> <span class="nc">OOError</span><span class="o">(</span><span class="n">message</span><span class="o">,</span> <span class="n">ex</span><span class="o">));</span> <span class="c1">// [1]</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="c1">// [1] : this OOError constructor (explicit message but no title) is missing</span>

<span class="nc">Optional</span><span class="o">&lt;</span><span class="no">B</span><span class="o">,</span> <span class="nc">OOError</span><span class="o">&gt;</span> <span class="nf">wrap_g</span><span class="o">(</span><span class="no">A</span> <span class="n">a</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
       <span class="k">return</span> <span class="nc">OOResult</span><span class="o">.</span><span class="na">ok</span><span class="o">(</span><span class="n">g</span><span class="o">(</span><span class="n">a</span><span class="o">));</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="no">G</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="nc">OOResult</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="nc">OOError</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">ex</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div> <p>and use it like this:</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">OOResult</span><span class="o">&lt;</span><span class="no">A</span><span class="o">,</span> <span class="nc">OOError</span><span class="o">&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">wrap_f</span><span class="o">();</span>
<span class="k">if</span> <span class="o">(</span><span class="n">testDialog</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="n">a</span><span class="o">))</span> <span class="o">{</span> <span class="c1">// [1]</span>
    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>

<span class="c1">// [1] needs boolean testDialog(String title, OOResultLike&lt;OOError&gt;... a);</span>
<span class="c1">//     where OOResultLike&lt;T&gt; is an interface with `OOVoidResult&lt;T&gt; asVoidResult()`</span>
<span class="c1">//     and is implemented by OOResult and OOVoidResult</span>

<span class="nc">OOResult</span><span class="o">&lt;</span><span class="no">B</span><span class="o">,</span> <span class="nc">OOError</span><span class="o">&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">wrap_g</span><span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
<span class="k">if</span> <span class="o">(</span><span class="n">testDialog</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="n">b</span><span class="o">))</span> <span class="o">{</span> <span class="k">return</span><span class="o">;</span> <span class="o">}</span> <span class="c1">// (checkstyle makes this 3 lines)</span>

<span class="k">try</span> <span class="o">{</span>
   <span class="n">realAction</span><span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">get</span><span class="o">(),</span> <span class="n">b</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(...)</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div> <p>If <code class="language-plaintext highlighter-rouge">g</code> did not need <code class="language-plaintext highlighter-rouge">a</code>, we could simplify to</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Optional</span><span class="o">&lt;</span><span class="no">A</span><span class="o">&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">wrap_f</span><span class="o">();</span>
<span class="nc">Optional</span><span class="o">&lt;</span><span class="no">B</span><span class="o">&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">wrap_g</span><span class="o">();</span>
<span class="k">if</span> <span class="o">(</span><span class="n">testDialog</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">))</span> <span class="o">{</span> <span class="c1">// a single dialog can show both messages</span>
  <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>

<span class="k">try</span> <span class="o">{</span>
   <span class="n">realAction</span><span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">get</span><span class="o">(),</span> <span class="n">b</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(...)</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div> <h3 id="notify-caller-by-throwing-an-exception"> <a href="#notify-caller-by-throwing-an-exception" class="anchor-heading" aria-labelledby="notify-caller-by-throwing-an-exception"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Notify caller by throwing an exception </h3> <p>Or we can throw an exception to notify the caller.</p> <p>To simplify code in the caller, I assume we are using an exception type not used elsewhere, but shared by all precondition checks.</p> <h4 id="dialog-in-wrap-preconditionexception"> <a href="#dialog-in-wrap-preconditionexception" class="anchor-heading" aria-labelledby="dialog-in-wrap-preconditionexception"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> [dialog in wrap, PreconditionException] </h4> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">A</span> <span class="nf">wrap_f</span><span class="o">(</span><span class="nc">String</span> <span class="n">title</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">PreconditionException</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
       <span class="k">return</span> <span class="nf">f</span><span class="o">();</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="no">F</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">showDialog</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="n">ex</span><span class="o">)</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nf">PreconditionException</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="no">B</span> <span class="nf">wrap_g</span><span class="o">(</span><span class="nc">String</span> <span class="n">title</span><span class="o">,</span> <span class="no">A</span> <span class="n">a</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">PreconditionException</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
       <span class="k">return</span> <span class="nf">g</span><span class="o">(</span><span class="n">a</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="no">G</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">showDialog</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="n">ex</span><span class="o">);</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nf">PreconditionException</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div> <p>use</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span> <span class="o">{</span>
   <span class="no">A</span> <span class="n">a</span> <span class="o">=</span> <span class="n">wrap_f</span><span class="o">(</span><span class="n">title</span><span class="o">);</span>
   <span class="no">B</span> <span class="n">b</span> <span class="o">=</span> <span class="n">wrap_g</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="n">a</span><span class="o">);</span>
   <span class="k">try</span> <span class="o">{</span>
     <span class="n">realAction</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">);</span>
   <span class="o">}</span> <span class="k">catch</span> <span class="o">(...)</span> <span class="o">{</span>
     <span class="n">showDialog</span><span class="o">(...)</span>
   <span class="o">}</span>
<span class="o">}</span> <span class="k">catch</span><span class="o">(</span> <span class="nc">PreconditionException</span> <span class="o">)</span> <span class="o">{</span>
   <span class="c1">// Only precondition checks get us here.</span>
   <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div> <p>or (since PreconditionException is not thrown from realAction)</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span> <span class="o">{</span>
   <span class="no">A</span> <span class="n">a</span> <span class="o">=</span> <span class="n">wrap_f</span><span class="o">(</span><span class="n">title</span><span class="o">);</span>
   <span class="no">B</span> <span class="n">b</span> <span class="o">=</span> <span class="n">wrap_g</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="n">a</span><span class="o">);</span>
   <span class="n">realAction</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(...)</span> <span class="o">{</span>
   <span class="c1">// Only realAction gets us here</span>
   <span class="n">showDialog</span><span class="o">(...)</span>
<span class="o">}</span> <span class="k">catch</span><span class="o">(</span> <span class="nc">PreconditionException</span> <span class="o">)</span> <span class="o">{</span>
   <span class="c1">// Only precondition checks get us here.</span>
   <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div> <p>or (separate try-catch for preconditions and realAction)</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">A</span> <span class="n">a</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="no">B</span> <span class="n">b</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">wrap_f</span><span class="o">(</span><span class="n">title</span><span class="o">);</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">wrap_g</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="n">a</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span><span class="o">(</span> <span class="nc">PreconditionException</span> <span class="o">)</span> <span class="o">{</span>
     <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>
<span class="k">try</span> <span class="o">{</span>
     <span class="n">realAction</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(...)</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div> <p>or to reduce passing around the title part:</p> <h4 id="preconditionexception-dialog-in-catch"> <a href="#preconditionexception-dialog-in-catch" class="anchor-heading" aria-labelledby="preconditionexception-dialog-in-catch"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> [PreconditionException, dialog in catch] </h4> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">A</span> <span class="nf">wrap_f</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">PreconditionException</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
       <span class="k">return</span> <span class="nf">f</span><span class="o">();</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="no">F</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nf">PreconditionException</span><span class="o">(</span><span class="n">message</span><span class="o">,</span> <span class="n">ex</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="no">B</span> <span class="nf">wrap_g</span><span class="o">(</span><span class="no">A</span> <span class="n">a</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">PreconditionException</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
       <span class="k">return</span> <span class="nf">g</span><span class="o">(</span><span class="n">a</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="no">G</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nf">PreconditionException</span><span class="o">(</span><span class="n">message</span><span class="o">,</span> <span class="n">ex</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div> <p>use</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span> <span class="o">{</span>
   <span class="no">A</span> <span class="n">a</span> <span class="o">=</span> <span class="n">wrap_f</span><span class="o">();</span>
   <span class="no">B</span> <span class="n">b</span> <span class="o">=</span> <span class="n">wrap_g</span><span class="o">(</span><span class="n">a</span><span class="o">);</span>
   <span class="k">try</span> <span class="o">{</span>
     <span class="n">realAction</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">);</span>
   <span class="o">}</span> <span class="k">catch</span> <span class="o">(...)</span> <span class="o">{</span>
      <span class="n">showDialog</span><span class="o">(...);</span>
   <span class="o">}</span>
<span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="nc">PreconditionException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
   <span class="n">showDialog</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="n">ex</span><span class="o">.</span><span class="na">message</span> <span class="o">);</span>
   <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div> <p>or</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span> <span class="o">{</span>
   <span class="no">A</span> <span class="n">a</span> <span class="o">=</span> <span class="n">wrap_f</span><span class="o">();</span>
   <span class="no">B</span> <span class="n">b</span> <span class="o">=</span> <span class="n">wrap_g</span><span class="o">(</span><span class="n">a</span><span class="o">);</span>
   <span class="n">realAction</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(...)</span> <span class="o">{</span>
   <span class="n">showDialog</span><span class="o">(...);</span>
<span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="nc">PreconditionException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
   <span class="n">showDialog</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="n">ex</span><span class="o">.</span><span class="na">message</span> <span class="o">);</span>
   <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div> <h2 id="push-associating-the-message-further-down"> <a href="#push-associating-the-message-further-down" class="anchor-heading" aria-labelledby="push-associating-the-message-further-down"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Push associating the message further down </h2> <p>As <a href="https://jabref.readthedocs.io/en/latest/getting-into-the-code/code-howtos/#throwing-and-catching-exceptions">the developers guide</a> suggest, we could “Catch and wrap all API exceptions” and rethrow them as a <code class="language-plaintext highlighter-rouge">JabRefException</code> or some exception derived from it. In this case the try-catch part goes even further down, and in principle we could just</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span> <span class="o">{</span>
   <span class="no">A</span> <span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="o">();</span>
   <span class="no">B</span> <span class="n">b</span> <span class="o">=</span> <span class="n">g</span><span class="o">(</span><span class="n">a</span><span class="o">);</span>
   <span class="n">realAction</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="nc">JabRefException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
   <span class="n">showDialog</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="n">ex</span><span class="o">.</span><span class="na">message</span> <span class="o">);</span>
   <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div> <p>Constraints:</p> <ul> <li>conversion to <code class="language-plaintext highlighter-rouge">JabRefException</code> cannot be done in <code class="language-plaintext highlighter-rouge">model</code> (since JabRefException is in <code class="language-plaintext highlighter-rouge">logic</code>)</li> <li><code class="language-plaintext highlighter-rouge">JabRefException</code> expects a localized message. Or we need to remember which <code class="language-plaintext highlighter-rouge">JabRefException</code> instances are localized and which need to be caught for localizing the message.</li> <li>At the bottom we usually have very little information on higher level contexts: at a failure like <code class="language-plaintext highlighter-rouge">NoSuchProperty</code> we cannot tell which set of properties did we look in and why.<br> For messages originating too deeply, we might want to override or extend the message anyway.</li> <li>for each exeption we might want to handle programmatically, we need a variant based on <code class="language-plaintext highlighter-rouge">JabRefException</code></li> </ul> <p>So we might end up:</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span> <span class="o">{</span>
   <span class="no">A</span> <span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="o">();</span>
   <span class="no">B</span> <span class="n">b</span> <span class="o">=</span> <span class="n">g</span><span class="o">(</span><span class="n">a</span><span class="o">);</span>
   <span class="n">realAction</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="nc">FDerivedFromJabRefException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
   <span class="n">showDialog</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="n">messageForF</span> <span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="nc">GDerivedFromJabRefException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
   <span class="n">showDialog</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="n">messageForG</span> <span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="nc">JabRefException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
   <span class="n">showDialog</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="n">ex</span><span class="o">.</span><span class="na">message</span> <span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// [1]</span>
   <span class="n">showDialog</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="n">ex</span><span class="o">.</span><span class="na">message</span><span class="o">,</span> <span class="n">ex</span> <span class="o">);</span>
   <span class="c1">// [1] does "never catch Exception or Throwable" apply at this point?</span>
   <span class="c1">//     Probably should not: we are promising not to throw.</span>
<span class="o">}</span>
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div> <p>which looks very similar to the original version.</p> <p>This again loses the information: can <code class="language-plaintext highlighter-rouge">GDerivedFromJabRefException</code> come from <code class="language-plaintext highlighter-rouge">realAction</code> or <code class="language-plaintext highlighter-rouge">f</code> or not? This is because we have pushed down the last catch/throw indefinitely (eliminating <code class="language-plaintext highlighter-rouge">wrap_f</code>) into a depth, where we cannot necessarily assign an appropriate message.</p> <p>To a lesser extent this also happens in <code class="language-plaintext highlighter-rouge">wrap_f</code>: it only knows about the action that called it what we provide (<code class="language-plaintext highlighter-rouge">title</code> or nothing). It knows the precondition it checks: probably an optimal location to assign a message.</p> <p><strong>Summary</strong>: going from top to bottom, we move to increasingly more local context, our knowledge shifts towards the “in which part of the code did we have a problem” and away from the high level (“which action”).</p> <p>One natural point to meet information from these to levels is the top level of action handlers. For precondition checking code a wrapper around code elsewhere may be considered. Using such wrappers may reduce duplication if called in multiple actions.</p> <p>We still have to signal failure to the action handler: the options considered above were using an <code class="language-plaintext highlighter-rouge">Optional</code> and throwing an exception with the appropriate message.</p> <p>The more promising variants were</p> <ul> <li><strong>[dialog in wrap, return Optional]</strong><br> <code class="language-plaintext highlighter-rouge">Optional&lt;A&gt; wrap_f(String title)</code> (showDialog inside) <ul> <li>pro: explicit return in caller</li> <li>con: explicit return in caller (boilerplate)</li> <li>con: passing in the title is repeated <ul> <li>would be ‘pro’ if we wanted title to vary within an action</li> </ul> </li> </ul> </li> <li><strong>[PreconditionException, dialog in catch]</strong><br> <code class="language-plaintext highlighter-rouge">A wrap_f() throws PreconditionException</code><br> (with <code class="language-plaintext highlighter-rouge">showDialog</code> under <code class="language-plaintext highlighter-rouge">catch(PreconditionException ex)</code>) <ul> <li>con: hidden control flow</li> <li>pro: no repeated <code class="language-plaintext highlighter-rouge">if(){return}</code> boilerplate</li> <li>pro: title used only once</li> </ul> </li> </ul> <h3 id="using-ooresult"> <a href="#using-ooresult" class="anchor-heading" aria-labelledby="using-ooresult"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> [using OOResult] </h3> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">final</span> <span class="nc">String</span> <span class="n">title</span> <span class="o">=</span> <span class="s">"Could not insert citation"</span><span class="o">;</span>

<span class="nc">OOResult</span><span class="o">&lt;</span><span class="nc">XTextDocument</span><span class="o">,</span> <span class="nc">OOError</span><span class="o">&gt;</span> <span class="n">odoc</span> <span class="o">=</span> <span class="n">getXTextDocument</span><span class="o">();</span>
<span class="k">if</span> <span class="o">(</span><span class="n">testDialog</span><span class="o">(</span><span class="n">title</span><span class="o">,</span>
               <span class="n">odoc</span><span class="o">,</span>
               <span class="n">styleIsRequired</span><span class="o">(</span><span class="n">style</span><span class="o">),</span>
               <span class="n">selectedBibEntryIsRequired</span><span class="o">(</span><span class="n">entries</span><span class="o">,</span> <span class="nl">OOError:</span><span class="o">:</span><span class="n">noEntriesSelectedForCitation</span><span class="o">)))</span> <span class="o">{</span>
    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>
<span class="nc">XTextDocument</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">odoc</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>

<span class="nc">OOResult</span><span class="o">&lt;</span><span class="nc">OOFrontend</span><span class="o">,</span> <span class="nc">OOError</span><span class="o">&gt;</span> <span class="n">ofr</span> <span class="o">=</span> <span class="n">getFrontend</span><span class="o">(</span><span class="n">doc</span><span class="o">);</span>
<span class="k">if</span> <span class="o">(</span><span class="n">testDialog</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="n">ofr</span><span class="o">))</span> <span class="o">{</span>
    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>
<span class="nc">OOFrontend</span> <span class="n">fr</span> <span class="o">=</span> <span class="n">ofr</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>

<span class="nc">OOResult</span><span class="o">&lt;</span><span class="nc">XTextCursor</span><span class="o">,</span> <span class="nc">OOError</span><span class="o">&gt;</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">getUserCursorForTextInsertion</span><span class="o">(</span><span class="n">doc</span><span class="o">);</span>
<span class="k">if</span> <span class="o">(</span><span class="n">testDialog</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="n">cursor</span><span class="o">))</span> <span class="o">{</span>
    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>
<span class="o">...</span>
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div> <h3 id="using-preconditionexception-dialog-in-catch"> <a href="#using-preconditionexception-dialog-in-catch" class="anchor-heading" aria-labelledby="using-preconditionexception-dialog-in-catch"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> [using PreconditionException, dialog in catch] </h3> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">final</span> <span class="nc">String</span> <span class="n">title</span> <span class="o">=</span> <span class="s">"Could not insert citation"</span><span class="o">;</span>

<span class="k">try</span> <span class="o">{</span>
  <span class="nc">XTextDocument</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">getXTextDocument</span><span class="o">();</span>
  <span class="n">styleIsRequired</span><span class="o">(</span><span class="n">style</span><span class="o">);</span>
  <span class="n">selectedBibEntryIsRequired</span><span class="o">(</span><span class="n">entries</span><span class="o">,</span> <span class="nl">OOError:</span><span class="o">:</span><span class="n">noEntriesSelectedForCitation</span><span class="o">);</span>
  <span class="nc">OOFrontend</span> <span class="n">fr</span> <span class="o">=</span> <span class="n">getFrontend</span><span class="o">(</span><span class="n">doc</span><span class="o">);</span>
  <span class="nc">XTextCursor</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">getUserCursorForTextInsertion</span><span class="o">(</span><span class="n">doc</span><span class="o">);</span>
  <span class="o">...</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">PreconditionException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
   <span class="n">showDialog</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="n">ex</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(...)</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div> <p>I would suggest using the latter,</p> <ul> <li>probably using <code class="language-plaintext highlighter-rouge">OOError</code> for <code class="language-plaintext highlighter-rouge">PreconditionException</code> <ul> <li>In this case <code class="language-plaintext highlighter-rouge">OOError</code> being in <code class="language-plaintext highlighter-rouge">gui</code> becomes an asset: we can be sure code in <code class="language-plaintext highlighter-rouge">logic</code> cannot throw it.</li> </ul> </li> <li>We lose the capability to collect mmessages in a single dialog (we stop processing at the first problem).</li> <li>The division between precondition checking (only throws PreconditionException) and <code class="language-plaintext highlighter-rouge">realAction</code>becomes invisible in the action code.</li> </ul> </main> <hr> <footer> <div class="d-flex mt-2"> <p class="text-small text-grey-dk-000 mb-0"> <a href="https://github.com/jabref/jabref/edit/main/docs/code-howtos/openoffice/ooresult-ooerror/ooresult-alternatives.md" id="edit-this-page">Edit this page on GitHub.</a> </p> </div> </footer> </div> </div> <div class="search-overlay"></div> </div> <script src="https://cdn.jsdelivr.net/npm/mermaid@9.4.3/dist/mermaid.min.js"></script> <script> var config = {} ; mermaid.initialize(config); window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid')); </script>  
</body></html>