<!DOCTYPE html><html lang="en-US"><head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet" disabled=""> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li:not(:nth-child(4)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(6) > ul > li:nth-child(1) > ul > li:nth-child(4) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(6) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(6) > ul > li:nth-child(1) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(6) > ul > li:nth-child(1) > ul > li:nth-child(4) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(6) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(6) > ul.nav-list > li.nav-list-item:nth-child(1) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(6) > ul.nav-list > li.nav-list-item:nth-child(1) > ul.nav-list > li.nav-list-item:nth-child(4) > ul.nav-list { display: block; } </style> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="icon" href="/images/favicon.ico" type="image/x-icon"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Code reorganization | Developer Documentation</title> <meta name="generator" content="Jekyll v4.3.4"> <meta property="og:title" content="Code reorganization"> <meta property="og:locale" content="en_US"> <meta name="description" content="Graphical Java application for managing BibTeX and BibLaTeX (.bib) databases"> <meta property="og:description" content="Graphical Java application for managing BibTeX and BibLaTeX (.bib) databases"> <link rel="canonical" href="/code-howtos/openoffice/code-reorganization.html"> <meta property="og:url" content="/code-howtos/openoffice/code-reorganization.html"> <meta property="og:site_name" content="Developer Documentation"> <meta property="og:type" content="website"> <meta name="twitter:card" content="summary"> <meta property="twitter:title" content="Code reorganization"> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Graphical Java application for managing BibTeX and BibLaTeX (.bib) databases","headline":"Code reorganization","url":"/code-howtos/openoffice/code-reorganization.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"></path> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"></path> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"></path> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"></path> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> Developer Documentation </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Overview on Developing JabRef</a></li><li class="nav-list-item"><a href="/contributing.html" class="nav-list-link">Contributing</a></li><li class="nav-list-item"><a href="/teaching.html" class="nav-list-link">JabRef and Software Engineering Training</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Decision Records category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/decisions/" class="nav-list-link">Decision Records</a><ul class="nav-list"><li class="nav-list-item"><a href="/decisions/0000-use-markdown-architectural-decision-records.html" class="nav-list-link">Use Markdown Architectural Decision Records</a></li><li class="nav-list-item"><a href="/decisions/0001-use-crowdin-for-translations.html" class="nav-list-link">Use Crowdin for translations</a></li><li class="nav-list-item"><a href="/decisions/0002-use-slf4j-for-logging.html" class="nav-list-link">Use SLF4J together with log4j2 for logging</a></li><li class="nav-list-item"><a href="/decisions/0003-use-gradle-as-build-tool.html" class="nav-list-link">Use Gradle as build tool</a></li><li class="nav-list-item"><a href="/decisions/0004-use-mariadb-connector.html" class="nav-list-link">Use MariaDB Connector</a></li><li class="nav-list-item"><a href="/decisions/0005-fully-support-utf8-only-for-latex-files.html" class="nav-list-link">Fully Support UTF-8 Only For LaTeX Files</a></li><li class="nav-list-item"><a href="/decisions/0006-only-translated-strings-in-language-file.html" class="nav-list-link">Only translated strings in language file</a></li><li class="nav-list-item"><a href="/decisions/0007-human-readable-changelog.html" class="nav-list-link">Provide a human-readable changelog</a></li><li class="nav-list-item"><a href="/decisions/0008-use-public-final-instead-of-getters.html" class="nav-list-link">Use public final instead of getters to offer access to immutable variables</a></li><li class="nav-list-item"><a href="/decisions/0009-use-plain-junit5-for-testing.html" class="nav-list-link">Use Plain JUnit5 for advanced test assertions</a></li><li class="nav-list-item"><a href="/decisions/0010-use-h2-as-internal-database.html" class="nav-list-link">Use H2 as Internal SQL Database</a></li><li class="nav-list-item"><a href="/decisions/0011-test-external-links-in-documentation.html" class="nav-list-link">Test external links in documentation</a></li><li class="nav-list-item"><a href="/decisions/0012-handle-different-bibEntry-formats-of-fetchers.html" class="nav-list-link">Handle different bibentry formats of fetchers by adding a layer</a></li><li class="nav-list-item"><a href="/decisions/0013-add-native-support-biblatex-software.html" class="nav-list-link">Add Native Support for BibLatex-Software</a></li><li class="nav-list-item"><a href="/decisions/0014-separate-URL-creation-to-enable-proper-logging.html" class="nav-list-link">Separate URL creation to enable proper logging</a></li><li class="nav-list-item"><a href="/decisions/0015-support-an-abstract-query-syntax-for-query-conversion.html" class="nav-list-link">Query syntax design</a></li><li class="nav-list-item"><a href="/decisions/0016-mutable-preferences-objects.html" class="nav-list-link">Mutable preferences objects</a></li><li class="nav-list-item"><a href="/decisions/0017-allow-model-access-logic.html" class="nav-list-link">Allow org.jabref.model to access org.jabref.logic</a></li><li class="nav-list-item"><a href="/decisions/0018-use-regular-expression-to-split-multiple-sentence-titles.html" class="nav-list-link">Use regular expression to split multiple-sentence titles</a></li><li class="nav-list-item"><a href="/decisions/0019-implement-special-fields-as-separate-fields.html" class="nav-list-link">Implement special fields as separate fields</a></li><li class="nav-list-item"><a href="/decisions/0020-use-Jackson-to-parse-study-yml.html" class="nav-list-link">Use Jackson to parse study.yml</a></li><li class="nav-list-item"><a href="/decisions/0021-keep-study-as-a-dto.html" class="nav-list-link">Keep study as a DTO</a></li><li class="nav-list-item"><a href="/decisions/0022-remove-stop-words-during-query-transformation.html" class="nav-list-link">Remove stop words during query transformation</a></li><li class="nav-list-item"><a href="/decisions/0023-localized-preferences.html" class="nav-list-link">Localized Preferences</a></li><li class="nav-list-item"><a href="/decisions/0024-use-%23-as-indicator-for-BibTeX-string-constants.html" class="nav-list-link">Use # as indicator for BibTeX string constants</a></li><li class="nav-list-item"><a href="/decisions/0025-reviewdog-reviews.html" class="nav-list-link">Reviewdog findings are code reviews</a></li><li class="nav-list-item"><a href="/decisions/0026-use-jna-to-determine-default-directory.html" class="nav-list-link">Use Java Native Access to Determine Default Directory</a></li><li class="nav-list-item"><a href="/decisions/0032-store-chats-in-local-user-folder.html" class="nav-list-link">Store Chats Alongside Database</a></li><li class="nav-list-item"><a href="/decisions/0027-synchronization.html" class="nav-list-link">Synchronization with remote databases</a></li><li class="nav-list-item"><a href="/decisions/0033-store-chats-in-mvstore.html" class="nav-list-link">Store Chats in MVStore</a></li><li class="nav-list-item"><a href="/decisions/0028-http-return-bibtex-string.html" class="nav-list-link">Return BibTeX string and CSL Item JSON in the API</a></li><li class="nav-list-item"><a href="/decisions/0034-use-citation-key-for-grouping-chat-messages.html" class="nav-list-link">Use Citation Key for Grouping Chat Messages</a></li><li class="nav-list-item"><a href="/decisions/0029-cff-export-multiple-entries.html" class="nav-list-link">Exporting multiple entries to CFF</a></li><li class="nav-list-item"><a href="/decisions/0035-generate-embeddings-online.html" class="nav-list-link">Generate Embeddings Online</a></li><li class="nav-list-item"><a href="/decisions/0030-use-apache-commons-io-for-directory-monitoring.html" class="nav-list-link">Use Apache Commons IO for directory monitoring</a></li><li class="nav-list-item"><a href="/decisions/0036-use-textarea-for-chat-content.html" class="nav-list-link">Use TextArea for Chat Message Content</a></li><li class="nav-list-item"><a href="/decisions/0031-use-current-tab-for-deciding-style-type-for-oo.html" class="nav-list-link">Use currently active tab in Select style (OO Panel) to decide style type</a></li><li class="nav-list-item"><a href="/decisions/0037-rag-architecture-implementation.html" class="nav-list-link">RAG Architecture Implementation</a></li><li class="nav-list-item"><a href="/decisions/0042-use-webview-for-summarization-content.html" class="nav-list-link">Use WebView for Chat Message Content</a></li><li class="nav-list-item"><a href="/decisions/0038-use-entryId-for-bibentries.html" class="nav-list-link">Use BibEntry.getId for BibEntry at indexing</a></li><li class="nav-list-item"><a href="/decisions/0039-use-apache-velocity-as-template-engine.html" class="nav-list-link">Use Apache Velocity as template engine</a></li><li class="nav-list-item"><a href="/decisions/0040-display-front-cover-in-preview-tab.html" class="nav-list-link">Display front cover for book citations in the Preview tab</a></li><li class="nav-list-item"><a href="/decisions/0043-show-merge-dialog-when-importing-a-single-pdf.html" class="nav-list-link">Show merge dialog when importing a single PDF</a></li><li class="nav-list-item"><a href="/decisions/adr-template.html" class="nav-list-link">ADR Template</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Getting into the code category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/getting-into-the-code/" class="nav-list-link">Getting into the code</a><ul class="nav-list"><li class="nav-list-item"><a href="/getting-into-the-code/development-strategy.html" class="nav-list-link">JabRef’s development strategy</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Set up a local workspace category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/getting-into-the-code/guidelines-for-setting-up-a-local-workspace/" class="nav-list-link">Set up a local workspace</a><ul class="nav-list"><li class="nav-list-item"><a href="/getting-into-the-code/guidelines-for-setting-up-a-local-workspace/pre-01-github-account.html" class="nav-list-link">Pre Condition 1: GitHub Account</a></li><li class="nav-list-item"><a href="/getting-into-the-code/guidelines-for-setting-up-a-local-workspace/pre-02-software.html" class="nav-list-link">Pre Condition 2: Required Software</a></li><li class="nav-list-item"><a href="/getting-into-the-code/guidelines-for-setting-up-a-local-workspace/pre-03-code.html" class="nav-list-link">Pre Condition 3: Code on the local machine</a></li><li class="nav-list-item"><a href="/getting-into-the-code/guidelines-for-setting-up-a-local-workspace/intellij-11-code-into-ide.html" class="nav-list-link">Step 1: Get the code into IntelliJ</a></li><li class="nav-list-item"><a href="/getting-into-the-code/guidelines-for-setting-up-a-local-workspace/intellij-12-build.html" class="nav-list-link">Step 2: Set up the build system: JDK and Gradle</a></li><li class="nav-list-item"><a href="/getting-into-the-code/guidelines-for-setting-up-a-local-workspace/intellij-13-code-style.html" class="nav-list-link">Step 3: Set up JabRef’s code style</a></li><li class="nav-list-item"><a href="/getting-into-the-code/guidelines-for-setting-up-a-local-workspace/intellij-89-run-with-intellij.html" class="nav-list-link">Advanced: Build and run using IntelliJ IDEA</a></li><li class="nav-list-item"><a href="/getting-into-the-code/guidelines-for-setting-up-a-local-workspace/eclipse.html" class="nav-list-link">Advanced: Eclipse as IDE</a></li><li class="nav-list-item"><a href="/getting-into-the-code/guidelines-for-setting-up-a-local-workspace/vscode.html" class="nav-list-link">Advanced: VS Code as IDE</a></li><li class="nav-list-item"><a href="/getting-into-the-code/guidelines-for-setting-up-a-local-workspace/trouble-shooting.html" class="nav-list-link">Trouble shooting</a></li></ul></li><li class="nav-list-item"><a href="/getting-into-the-code/high-level-documentation.html" class="nav-list-link">High-level documentation</a></li></ul></li><li class="nav-list-item active"><button class="nav-list-expander btn-reset" aria-label="toggle items in Code Howtos category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/code-howtos/" class="nav-list-link">Code Howtos</a><ul class="nav-list"><li class="nav-list-item active"><button class="nav-list-expander btn-reset" aria-label="toggle items in The LibreOffice Panel category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/code-howtos/openoffice/" class="nav-list-link">The LibreOffice Panel</a><ul class="nav-list"><li class="nav-list-item"><a href="/code-howtos/openoffice/overview.html" class="nav-list-link">Overview</a></li><li class="nav-list-item"><a href="/code-howtos/openoffice/order-of-appearance.html" class="nav-list-link">Order of appearance of citation groups</a></li><li class="nav-list-item"><a href="/code-howtos/openoffice/problems.html" class="nav-list-link">Problems</a></li><li class="nav-list-item active"><a class="nav-list-link active">Code reorganization</a></li><li class="nav-list-item"><a href="/code-howtos/openoffice/ooresult-ooerror/" class="nav-list-link">About OOError, OOResult, and OOVoidResult</a></li><li class="nav-list-item"><a href="/code-howtos/openoffice/ooresult-ooerror/ooresult-alternatives.html" class="nav-list-link">Alternatives to using OOResult and OOVoidResult in OOBibBase</a></li></ul></li><li class="nav-list-item"><a href="/code-howtos/code-quality.html" class="nav-list-link">Code Quality</a></li><li class="nav-list-item"><a href="/code-howtos/custom-svg-icons.html" class="nav-list-link">Custom SVG icons</a></li><li class="nav-list-item"><a href="/code-howtos/error-handling.html" class="nav-list-link">Error Handling in JabRef</a></li><li class="nav-list-item"><a href="/code-howtos/eventbus.html" class="nav-list-link">Event Bus and Event System</a></li><li class="nav-list-item"><a href="/code-howtos/fetchers.html" class="nav-list-link">Fetchers</a></li><li class="nav-list-item"><a href="/code-howtos/faq.html" class="nav-list-link">Frequently Asked Questions (FAQ)</a></li><li class="nav-list-item"><a href="/code-howtos/http-server.html" class="nav-list-link">HTTP Server</a></li><li class="nav-list-item"><a href="/code-howtos/IntelliJ.html" class="nav-list-link">IntelliJ Hints</a></li><li class="nav-list-item"><a href="/code-howtos/jpackage.html" class="nav-list-link">JPackage: Creating a binary and debug it</a></li><li class="nav-list-item"><a href="/code-howtos/bibtex.html" class="nav-list-link">JabRef’s handling of BibTeX</a></li><li class="nav-list-item"><a href="/code-howtos/javafx.html" class="nav-list-link">JavaFX</a></li><li class="nav-list-item"><a href="/code-howtos/localization.html" class="nav-list-link">Localization</a></li><li class="nav-list-item"><a href="/code-howtos/logging.html" class="nav-list-link">Logging</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Remote Storage category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/code-howtos/remote-storage.html" class="nav-list-link">Remote Storage</a><ul class="nav-list"><li class="nav-list-item"><a href="/code-howtos/remote-storage-jabdrive.html" class="nav-list-link">Remote JabDrive storage</a></li><li class="nav-list-item"><a href="/code-howtos/remote-storage-sql.html" class="nav-list-link">Remote SQL Storage</a></li></ul></li><li class="nav-list-item"><a href="/code-howtos/testing.html" class="nav-list-link">Testing JabRef</a></li><li class="nav-list-item"><a href="/code-howtos/ui-recommendations.html" class="nav-list-link">UI Design Recommendations</a></li><li class="nav-list-item"><a href="/code-howtos/tools.html" class="nav-list-link">Useful development tooling</a></li><li class="nav-list-item"><a href="/code-howtos/xmp-parsing.html" class="nav-list-link">XMP Parsing</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Requirements category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/requirements/" class="nav-list-link">Requirements</a><ul class="nav-list"><li class="nav-list-item"><a href="/requirements/ai.html" class="nav-list-link">AI</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Developer Documentation" aria-label="Search Developer Documentation" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://gitter.im/JabRef/jabref" class="site-button"> Gitter Chat </a> </li> <li class="aux-nav-list-item"> <a href="https://discourse.jabref.org/" class="site-button"> Discussion Forum </a> </li> <li class="aux-nav-list-item"> <a href="https://github.com/jabref/jabref/" class="site-button"> Code Repository </a> </li> </ul> </nav> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/code-howtos/">Code Howtos</a></li> <li class="breadcrumb-nav-list-item"><a href="/code-howtos/openoffice/">The LibreOffice Panel</a></li> <li class="breadcrumb-nav-list-item"><span>Code reorganization</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h1 id="code-reorganization"> <a href="#code-reorganization" class="anchor-heading" aria-labelledby="code-reorganization"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Code reorganization </h1> <p>Why</p> <ul> <li>Separate backend</li> <li>Separate GUI code (dialogs) and logic</li> <li>Data is now organized around <code class="language-plaintext highlighter-rouge">Citation</code>, <code class="language-plaintext highlighter-rouge">CitationGroup</code> instead of arrays for citation group fields, and arrays of arrays for citation fields.<br> Also take <code class="language-plaintext highlighter-rouge">citationKey</code> as the central data unit, this is what we start with: unresolved <code class="language-plaintext highlighter-rouge">citationKeys</code> do not stop processing. Although we cannot sort them by author and year, we can still emit a marker that acts as a placeholder and shows the user the problematic key.</li> </ul> <h2 id="result"> <a href="#result" class="anchor-heading" aria-labelledby="result"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Result </h2> <h3 id="layers"> <a href="#layers" class="anchor-heading" aria-labelledby="layers"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Layers </h3> <p><img src="/code-howtos/openoffice/layers-v1.svg" alt="Layers"></p> <h3 id="by-directories"> <a href="#by-directories" class="anchor-heading" aria-labelledby="by-directories"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> By directories </h3> <ul> <li><code class="language-plaintext highlighter-rouge">model</code> <ul> <li><code class="language-plaintext highlighter-rouge">util</code> : general utilities <ul> <li>(<code class="language-plaintext highlighter-rouge">OOPair</code>, <code class="language-plaintext highlighter-rouge">OOTuple3</code>) collect two or three objects without creating a new class</li> <li><code class="language-plaintext highlighter-rouge">OOResult</code> : while an Optional.empty can comunicate failure, it cannot provide details.<br> <code class="language-plaintext highlighter-rouge">OOResult</code> allows an arbitrary error object to be provided in case of failure.</li> <li><code class="language-plaintext highlighter-rouge">OOVoidResult</code> : for functions returning no result on success, only diagnostics on failure.</li> <li><code class="language-plaintext highlighter-rouge">OOListUtil</code>: some utilities working on List</li> </ul> </li> <li><code class="language-plaintext highlighter-rouge">uno</code> : helpers for various tasks via UNO.<br> These are conceptually independent of JabRef code and logic.</li> <li><code class="language-plaintext highlighter-rouge">ootext</code> : to separate decisions on the format of references and citation marks from the actual insertion into the document, the earlier method <code class="language-plaintext highlighter-rouge">OOUtil.insertOOFormattedTextAtCurrentLocation</code> was extended to handle new tags that describe actions earlier done in code. <ul> <li>This became <code class="language-plaintext highlighter-rouge">OOTextIntoOO.write</code> <ul> <li><code class="language-plaintext highlighter-rouge">(change)</code> Now all output to the document goes through this, not only those from Layout. This allows the citation markers and <code class="language-plaintext highlighter-rouge">jstyle:Title</code> to use these tags. <ul> <li>This allows some backward-compatible extensions to jstyle.<br> <code class="language-plaintext highlighter-rouge">(change)</code> Added some extra keywords, in <code class="language-plaintext highlighter-rouge">{prefix}_MARKUP_BEFORE</code>, <code class="language-plaintext highlighter-rouge">{prefix}_MARKUP_AFTER</code> pairs to allow bracketing some parts of citation marks with text and/or open/close tag pairs.</li> </ul> </li> </ul> </li> <li><code class="language-plaintext highlighter-rouge">OOFormat</code> contains helpers to create the appropriate tags</li> <li><code class="language-plaintext highlighter-rouge">OOText</code> formalizes the distinction from <code class="language-plaintext highlighter-rouge">String</code>. I did not change <code class="language-plaintext highlighter-rouge">String</code> to <code class="language-plaintext highlighter-rouge">OOText</code> in old code, (in particular in OOStyle).</li> </ul> </li> <li><code class="language-plaintext highlighter-rouge">rangesort</code> : ordering objects that have an <code class="language-plaintext highlighter-rouge">XTextRange</code>, optionally with an extra integer to break ties. <ul> <li><code class="language-plaintext highlighter-rouge">RangeSort.partitionAndSortRanges</code> : since <code class="language-plaintext highlighter-rouge">XTextRangeCompare</code> can only compare <code class="language-plaintext highlighter-rouge">XTextRange</code> values in the same <code class="language-plaintext highlighter-rouge">XText</code>, we partition them accordingly and only sort within each partition.</li> <li><code class="language-plaintext highlighter-rouge">RangeSortable</code> (interface), <code class="language-plaintext highlighter-rouge">RangeSortEntry</code> (implements) :<br> When we replace <code class="language-plaintext highlighter-rouge">XTextRange</code> of citation marks in footnotes with the range of the footnote mark, multiple citation marks may be mapped to the same location. To preserve the order between these, <code class="language-plaintext highlighter-rouge">RangeSortable</code> allows this order to be indicated by returning appropriate indices from <code class="language-plaintext highlighter-rouge">getIndexInPosition</code></li> <li><code class="language-plaintext highlighter-rouge">RangeSortVisual</code> : sort in top-to-bottom left-to-right order.<br> Needs a functional <code class="language-plaintext highlighter-rouge">XTextViewCursor</code>.<br> Works on <code class="language-plaintext highlighter-rouge">RangeSortable</code> values.</li> <li><code class="language-plaintext highlighter-rouge">FunctionalTextViewCursor</code> : helper to get a functional <code class="language-plaintext highlighter-rouge">XTextViewCursor</code> (cannot always)</li> <li><code class="language-plaintext highlighter-rouge">RangeOverlapWithin</code> : check for overlaps within a set of <code class="language-plaintext highlighter-rouge">XTextRange</code> values. Probably O(n*log(n)). Used for all-to-all check of protected ranges.</li> <li><code class="language-plaintext highlighter-rouge">RangeOverlapBetween</code> : check for overlaps between two sets of <code class="language-plaintext highlighter-rouge">XTextRange</code> values. Assumes one set is small. O(n*k). Used for checking if the cursor is in a protected range.</li> </ul> </li> <li><code class="language-plaintext highlighter-rouge">backend</code> : interfaces to be provided by backends.<br> May change as new backends may need different APIs.</li> <li><code class="language-plaintext highlighter-rouge">style</code> : data structures and interfaces used while going from ordered list of citation groups to formatted citation markers and bibliography. Does not communicate with the document. Too long to fit here, starting a new section.</li> </ul> </li> </ul> <h2 id="modelstyle"> <a href="#modelstyle" class="anchor-heading" aria-labelledby="modelstyle"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> model/style </h2> <p>At the core,</p> <ul> <li>we have <code class="language-plaintext highlighter-rouge">Citation</code> values <ul> <li>represented in the document by their <code class="language-plaintext highlighter-rouge">citationKey</code></li> <li>each may have a <code class="language-plaintext highlighter-rouge">pageInfo</code></li> </ul> </li> <li>A citation group (<code class="language-plaintext highlighter-rouge">CitationGroup</code>) has <ul> <li>a list of citations (<code class="language-plaintext highlighter-rouge">citationsInStorageOrder</code>)</li> <li>an identifier <code class="language-plaintext highlighter-rouge">CitationGroupId cgid</code> <ul> <li>this allows to refer to the group</li> <li>also used to associate the group to its citation markers location (outside the style part, in <code class="language-plaintext highlighter-rouge">Backend52</code>)</li> </ul> </li> <li><code class="language-plaintext highlighter-rouge">OODataModel dataModel</code> is here, in order to handle old (Jabref5.2) structure where pageInfo belonged to CitationGroup not Citation</li> <li><code class="language-plaintext highlighter-rouge">referenceMarkNameForLinking</code> is optional: can be used to crosslink to the citation marker from the bibliography.</li> </ul> </li> <li><code class="language-plaintext highlighter-rouge">CitationGroups</code> represents the collection of citation groups.<br> Processing starts with creating a <code class="language-plaintext highlighter-rouge">CitationGroups</code> instance from the data stored in the document.</li> <li><code class="language-plaintext highlighter-rouge">CitedKey</code> represents a cited source, with ordered back references (using <code class="language-plaintext highlighter-rouge">CitationPath</code>) to the corresponding citations.</li> <li><code class="language-plaintext highlighter-rouge">CitedKeys</code> is just an order-preserving collection of <code class="language-plaintext highlighter-rouge">CitedKeys</code> that also supports lookup by <code class="language-plaintext highlighter-rouge">citationKey</code>. While producing citation markers, we also create a corresponding <code class="language-plaintext highlighter-rouge">CitedKeys</code> instance, and store it in <code class="language-plaintext highlighter-rouge">CitationGroups.bibliography</code>. This is already sorted, its entries have <code class="language-plaintext highlighter-rouge">uniqueLetter</code> or <code class="language-plaintext highlighter-rouge">number</code> assigned, but not converted to markup yet.</li> </ul> <p>Common processing steps:</p> <ul> <li>We need <code class="language-plaintext highlighter-rouge">globalOrder</code> for the citation groups (provided externally) <code class="language-plaintext highlighter-rouge">CitationGroups.setGlobalOrder()</code></li> <li>We need to look up each citationKey in the bibliography databases: <ul> <li><code class="language-plaintext highlighter-rouge">CitationGroups.lookupCitations</code> collects the cited keys, looks up each, then distributes the results to the citations. Uses a temporary <code class="language-plaintext highlighter-rouge">CitedKeys</code> instance, based on unsorted citations and citation groups.</li> </ul> </li> <li><code class="language-plaintext highlighter-rouge">CitationGroups.imposeLocalOrder</code> fills <code class="language-plaintext highlighter-rouge">localOrder</code> in each <code class="language-plaintext highlighter-rouge">CitationGroup</code></li> <li>Now we have order of appearance for the citations (<code class="language-plaintext highlighter-rouge">globalOrder</code> and <code class="language-plaintext highlighter-rouge">localOrder</code>).<br> We can create a <code class="language-plaintext highlighter-rouge">CitedKeys</code> instance (<code class="language-plaintext highlighter-rouge">bibliography</code>) according to this order.</li> <li>For citations numbered in order of first appearance we number the sources and distribute the numbers to the corresponding citations.</li> <li>For citations numbered in order of bibliography, we sort the bibliography, number, distribute.</li> <li>For author-year citations we have to decide on the letters <code class="language-plaintext highlighter-rouge">uniqueLetter</code> used to distinguish sources. This needs order of first appearance of the sources and recognizing clashing citation markers. This is done in logic, in <code class="language-plaintext highlighter-rouge">OOProcessAuthorYearMarkers.createUniqueLetters()</code></li> <li>We also mark first appearance of each source (<code class="language-plaintext highlighter-rouge">setIsFirstAppearanceOfSourceInCitations</code>)</li> </ul> <p>The entry point for this processing is: <code class="language-plaintext highlighter-rouge">OOProcess.produceCitationMarkers</code>.</p> <p>It fills</p> <ul> <li>each <code class="language-plaintext highlighter-rouge">CitationGroup.citationMarker</code></li> <li><code class="language-plaintext highlighter-rouge">CitationGroups.bibliography</code> <ul> <li>From bibliography <code class="language-plaintext highlighter-rouge">OOFormatBibliography.formatBibliography()</code> creates an <code class="language-plaintext highlighter-rouge">OOText</code> ready to be written to the document.</li> </ul> </li> </ul> <h2 id="logicstyle"> <a href="#logicstyle" class="anchor-heading" aria-labelledby="logicstyle"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> logic/style </h2> <ul> <li><code class="language-plaintext highlighter-rouge">StyleLoader</code> : not changed (knows about default styles) Used by GUI</li> <li><code class="language-plaintext highlighter-rouge">OOPreFormatter</code> : LaTeX code to unicode and OOText tags. (not changed)</li> <li><code class="language-plaintext highlighter-rouge">OOBibStyle</code> : is mostly concerned by loading/parsing jstyle files and presenting its pieces to the rest. Originally it also contains code to format numeric and author-year citation markers. <ul> <li>Details of their new implementations are in <code class="language-plaintext highlighter-rouge">OOBibStyleGetNumCitationMarker</code> and <code class="language-plaintext highlighter-rouge">OOBibStyleGetCitationMarker</code></li> <li>The new implementations <ul> <li>support pageInfo for each citation</li> <li>support unresolved citations</li> <li>instead of <code class="language-plaintext highlighter-rouge">List&lt;Integer&gt;</code> and (<code class="language-plaintext highlighter-rouge">List&lt;BibEntry&gt;</code> plus arrays and database) they expect more self-contained entries <code class="language-plaintext highlighter-rouge">List&lt;CitationMarkerNumericEntry&gt;</code>, <code class="language-plaintext highlighter-rouge">List&lt;CitationMarkerEntry&gt;</code>.</li> <li>We have distinct methods for <code class="language-plaintext highlighter-rouge">getNormalizedCitationMarker(CitationMarkerNormEntry)</code> and <code class="language-plaintext highlighter-rouge">getNumCitationMarkerForBibliography(CitationMarkerNumericBibEntry)</code>.</li> <li>The corresponding interfaces in model/style: <ul> <li><code class="language-plaintext highlighter-rouge">CitationMarkerNumericEntry</code></li> <li><code class="language-plaintext highlighter-rouge">CitationMarkerEntry</code></li> <li><code class="language-plaintext highlighter-rouge">CitationMarkerNumericBibEntry</code></li> <li><code class="language-plaintext highlighter-rouge">CitationMarkerNormEntry</code><br> describe their expected input entries.</li> </ul> </li> </ul> </li> </ul> </li> <li><code class="language-plaintext highlighter-rouge">OOProcess.produceCitationMarkers</code> is the main entry point for style application. Calls to specific implementations in <code class="language-plaintext highlighter-rouge">OOProcessCitationKeyMarkers</code>, <code class="language-plaintext highlighter-rouge">OOProcessNumericMarkers</code> and <code class="language-plaintext highlighter-rouge">OOProcessAuthorYearMarkers</code> according to jstyle flags.</li> </ul> <h2 id="logicbackend"> <a href="#logicbackend" class="anchor-heading" aria-labelledby="logicbackend"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> logic/backend </h2> <p>Details of encoding and retrieving data stored in a document as well as the citation maker locations. Also contains dataModel-dependent code (which could probably be moved out once the datamodel is settled).</p> <p>Creating and finding the bibliography (providing a cursor to write at) should be here too.<br> These are currently in <code class="language-plaintext highlighter-rouge">UpdateBibliography</code></p> <h2 id="logicfrontend"> <a href="#logicfrontend" class="anchor-heading" aria-labelledby="logicfrontend"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> logic/frontend </h2> <ul> <li><code class="language-plaintext highlighter-rouge">OOFrontend</code> : has a <code class="language-plaintext highlighter-rouge">Backend</code> and <code class="language-plaintext highlighter-rouge">CitationGroups</code> <ul> <li>Its constructor creates a backend, reads data from the document and creates a CitationGroups instance.</li> <li>provides functionality that requires both access to the document and the CitationGroups instance</li> </ul> </li> <li><code class="language-plaintext highlighter-rouge">RangeForOverlapCheck</code> used in <code class="language-plaintext highlighter-rouge">OOFrontend</code></li> <li><code class="language-plaintext highlighter-rouge">UpdateBibliography</code> : Create, find and update the bibliography in the document using output from <code class="language-plaintext highlighter-rouge">produceCitationMarkers()</code></li> <li><code class="language-plaintext highlighter-rouge">UpdateCitationMarkers</code> create <code class="language-plaintext highlighter-rouge">CitationGroup</code>, update citation markers using output from <code class="language-plaintext highlighter-rouge">produceCitationMarkers()</code></li> </ul> <h2 id="logicaction"> <a href="#logicaction" class="anchor-heading" aria-labelledby="logicaction"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> logic/action </h2> <p>GUI-independent part of implementations of GUI actions.</p> <h2 id="gui"> <a href="#gui" class="anchor-heading" aria-labelledby="gui"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> gui </h2> <ul> <li><code class="language-plaintext highlighter-rouge">OOError</code> : common error messages and dialog titles <ul> <li>adds <code class="language-plaintext highlighter-rouge">title</code> to <code class="language-plaintext highlighter-rouge">Jabrefexception</code></li> <li>converts from some common exception types using type-specific message</li> <li>contains some dialog messages that do not correspond to exceptions</li> </ul> </li> <li><code class="language-plaintext highlighter-rouge">OOBibBase2</code> : most activity was moved out from here to parts discussed above. <ul> <li>connecting / selecting a document moved to <code class="language-plaintext highlighter-rouge">OOBibBaseConnect</code></li> <li>the rest connects higher parts of the GUI to actions in logic <ul> <li>does argument and precondition checking</li> <li>catches all exceptions</li> <li>shows error and warning dialogs</li> <li>adds <code class="language-plaintext highlighter-rouge">enterUndoContext</code>, <code class="language-plaintext highlighter-rouge">leaveUndoContext</code> around action code</li> </ul> </li> </ul> </li> </ul> </main> <hr> <footer> <div class="d-flex mt-2"> <p class="text-small text-grey-dk-000 mb-0"> <a href="https://github.com/jabref/jabref/edit/main/docs/code-howtos/openoffice/code-reorganization.md" id="edit-this-page">Edit this page on GitHub.</a> </p> </div> </footer> </div> </div> <div class="search-overlay"></div> </div> <script src="https://cdn.jsdelivr.net/npm/mermaid@9.4.3/dist/mermaid.min.js"></script> <script> var config = {} ; mermaid.initialize(config); window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid')); </script>  
</body></html>